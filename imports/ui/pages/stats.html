<template name="stats">
  {{#if character}}
    <div class="stats-container">
      <div class="key-character-status">
        <h1>{{character.name}}</h1>
        <div class="body-boxes-container">
          <div class="row">
            <div class="head-box">
              {{#if equippedHead}}
                <img src="{{equippedHead.img}}"/>
              {{/if}}
            </div>
          </div>
          <div class="row">
            <div class="left-arm-box">
              {{#if equippedLeftHand}}
                <img src="{{equippedLeftHand.img}}"/>
              {{/if}}
            </div>
            <div class="chest-box">
              {{#if equippedChest}}
                <img src="{{equippedChest.img}}"/>
              {{/if}}
            </div>
            <div class="right-arm-box">
              {{#if equippedRightHand}}
                <img src="{{equippedRightHand.img}}"/>
              {{/if}}
            </div>
          </div>
          <div class="row">
            <div class="legs-box">
              {{#if equippedLegs}}
                <img src="{{equippedLegs.img}}"/>
              {{/if}}
            </div>
          </div>
        </div>
        {{> statusBars}}
        {{> miscStatus character}}

      </div>
      <div class="detail-tabs-container">
        <div class="tab-links">
          <a href="#" data-page="Skills" class="{{page 'Skills'}}">Skills</a>
          <a href="#" data-page="Items" class="{{page 'Items'}}">Items</a>
          <a href="#" data-page="Resources" class="{{page 'Resources'}}">Resources</a>
          {{#if hasBuilding}}
            <a href="#" data-page="Buildings" class="{{page 'Buildings'}}">Buildings</a>
          {{/if}}
        </div>
        {{#if page 'Skills'}}
          <div class="skills-display-container">
            <h2>Basic combat skills</h2>
            <li data-stat="strength"><i class="fa fa-caret-right"></i> Strength: {{decimal character.stats.strength}} / {{decimal character.stats.baseStrength}}</li>
            <li data-stat="accuracy"><i class="fa fa-caret-right"></i> Accuracy: {{decimal character.stats.accuracy}} / {{decimal character.stats.baseAccuracy}}</li>
            <li data-stat="agility"><i class="fa fa-caret-right"></i> Agility: {{decimal character.stats.agility}} / {{decimal character.stats.baseAgility}}</li>
            <li data-stat="toughness"><i class="fa fa-caret-right"></i> Toughness: {{decimal character.stats.toughness}} / {{decimal character.stats.baseToughness}}</li>
            <h2>Weapon skills</h2>
            <li data-stat="weapon.hands"><i class="fa fa-caret-right"></i> Hands: {{decimal character.stats.weapon.hands}} / {{decimal character.stats.weapon.handsBase}}</li>
            <li data-stat="weapon.smallBlade"><i class="fa fa-caret-right"></i> Small Blade: {{decimal character.stats.weapon.smallBlade}} / {{decimal character.stats.weapon.smallBladeBase}}</li>
            <li data-stat="weapon.largeBlade"><i class="fa fa-caret-right"></i> Large Blade: {{decimal character.stats.weapon.largeBlade}} / {{decimal character.stats.weapon.largeBladeBase}}</li>
            <li data-stat="weapon.axe"><i class="fa fa-caret-right"></i> Axe: {{decimal character.stats.weapon.axe}} / {{decimal character.stats.weapon.axeBase}}</li>
            <h2>Resource collection skills</h2>
            <li data-stat="collecting.wood"><i class="fa fa-caret-right"></i> Wood: {{decimal character.stats.collecting.wood}} / {{decimal character.stats.collecting.woodBase}}</li>
            <li data-stat="collecting.hide"><i class="fa fa-caret-right"></i> Hide: {{decimal character.stats.collecting.hide}} / {{decimal character.stats.collecting.hideBase}}</li>
            <li data-stat="collecting.leather"><i class="fa fa-caret-right"></i> Leather: {{decimal character.stats.collecting.leather}} / {{decimal character.stats.collecting.leatherBase}}</li>
            <li data-stat="collecting.ore"><i class="fa fa-caret-right"></i> Ore: {{decimal character.stats.collecting.ore}} / {{decimal character.stats.collecting.oreBase}}</li>
            <li data-stat="collecting.metal"><i class="fa fa-caret-right"></i> Metal: {{decimal character.stats.collecting.metal}} / {{decimal character.stats.collecting.metalBase}}</li>
            <h2>Miscellaneous skills</h2>
            <li data-stat="endurance"><i class="fa fa-caret-right"></i> Endurance: {{decimal character.stats.endurance}}</li>
          </div>
        {{/if}}
        {{#if page 'Items'}}
          <div class="items-display-container">
            {{#each itemX in items}}
              <div class="{{itemSelectedClass itemX}}">
                {{> item itemX}}
              </div>
            {{else}}
              <p>You aren't carrying any items. What are you, poor?</p>
            {{/each}}
          </div>
        {{/if}}
        {{#if page 'Resources'}}
          <div class="resources-display-container">
            <li>
              <i class="fa fa-caret-right"></i> Wood: {{character.stats.resources.wood}} lbs 
              {{#if droppingResource 'wood'}}
                <input type="text" class="drop-resource-amount"/> 
              {{/if}}
              <a href="#" class="drop" data-resource="wood">drop</a>
            </li>
            <li>
              <i class="fa fa-caret-right"></i> Hide: {{character.stats.resources.hide}} lbs 
              {{#if droppingResource 'hide'}}
                <input type="text" class="drop-resource-amount"/>
              {{/if}}
              <a href="#" class="drop" data-resource="hide">drop</a>
            </li>
            <li>
              <i class="fa fa-caret-right"></i> Leather: {{character.stats.resources.leather}} lbs 
              {{#if droppingResource 'leather'}}
                <input type="text" class="drop-resource-amount"/>
              {{/if}}
              <a href="#" class="drop" data-resource="leather">drop</a>
            </li>
            <li>
              <i class="fa fa-caret-right"></i> Ore: {{character.stats.resources.ore}} lbs 
              {{#if droppingResource 'ore'}}
                <input type="text" class="drop-resource-amount"/>
              {{/if}}
              <a href="#" class="drop" data-resource="ore">drop</a>
            </li>
            <li>
              <i class="fa fa-caret-right"></i> Metal: {{character.stats.resources.metal}} lbs 
              {{#if droppingResource 'metal'}}
                <input type="text" class="drop-resource-amount"/>
              {{/if}}
              <a href="#" class="drop" data-resource="metal">drop</a>
            </li>
          </div>
        {{/if}}
        {{#if page 'Buildings'}}
          <div class="buildings-display-container">
            {{#each building in buildings}}
              <div class="building-card" data-id="{{building._id}}">
                <img src="{{building.image}}"/>
                <div>
                  <p>{{building.roomName}} [{{building.upperLeft.x}}, {{building.upperLeft.y}}]</p>
                  <p>{{building.typeLabel}} {{#if building.underConstruction}}<span>Under Construction</span>{{/if}}</p>
                </div>
              </div>
            {{/each}}
          </div>
        {{/if}}
      </div>
      <div class="action-menu-container">
        {{#if selectedStat}}
          <div class="stat-description">
            <p>{{selectedStat}}</p>
          </div>
        {{/if}}
        {{#if selectedItem}}
          <div class="item-action-menu">
            <div class="item-info">
              <h3>{{selectedItem.name}}</h3>
              <p>Weight: {{selectedItem.weight}}lbs</p>
              <p>Type: {{selectedItem.type}}</p>
              {{#if itemDescription}}
                <p>{{itemDescription}}</p>
              {{/if}}
            </div>
            <div class="item-actions">
              {{#if selectedItem.equipped}}
                <div class="action" data-action="unequip" data-id="{{selectedItem._id}}"><i class="fa fa-caret-right"></i> Unequip</div>
              {{else}}
                {{#if selectedItem.equipSlot}}
                  <div class="action" data-action="equip" data-id="{{selectedItem._id}}"><i class="fa fa-caret-right"></i> Equip</div>
                {{else}}
                  <div class="action" data-action="use" data-id="{{selectedItem._id}}"><i class="fa fa-caret-right"></i> Use</div>
                {{/if}}
              {{/if}}
              <div class="action" data-action="drop" data-id="{{selectedItem._id}}"><i class="fa fa-caret-right"></i> Drop</div>
            </div>
          </div>
        {{/if}}
        {{#if selectedBuilding}}
          <div class="building-managment-menu">
            <div class="building-info">
              {{#if buildingMenu 'create'}}
                <p>Choose a type of building to construct</p>
                {{#each type in buildingTypes}}
                  <div class="{{#if selectedBuildingTypeToCreate type.key}}selected{{/if}} building-type" data-key="{{type.key}}">
                    <p>{{type.label}}: {{type.description}}</p>
                    <ul>
                      Cost:
                      {{#each cost in type.cost}}
                        <li>{{cost.resource}}: {{cost.amount}}</li>
                      {{else}}
                        none
                      {{/each}}
                    </ul>
                  </div>
                {{/each}}
              {{/if}}
              {{#if buildingMenu 'description'}}
                <p>Some basic info about the current state of your building</p>
                {{#if selectedBuilding.underConstruction}}
                  <p>Construction:</p>
                  {{#each needed in buildingConstructionProgress}}
                    <p>{{needed.resource}}: {{needed.has}} / {{needed.amount}}</p>
                  {{/each}}
                {{/if}}
              {{/if}}
            </div>
            <div class="building-actions-menu">
              {{#if buildingMenu 'description'}}
                {{#if selectedBuilding.underConstruction}}
                {{else}}
                  <div class="action-menu" data-menu="create">Start Construction</div>
                {{/if}}
              {{/if}}
              {{#if buildingMenu 'create'}}
                {{#if selectedBuildingTypeToCreate}}
                  <div class="action" data-action="construct" data-id="{{selectedBuilding._id}}" data-params='["{{selectedBuildingTypeToCreate}}"]'>Create</div>
                {{/if}}
              {{/if}}
              <div class="action-menu" data-menu="description">Cancel</div>
            </div>
          </div>
        {{/if}}
      </div>
    </div>
  {{/if}}
</template>
